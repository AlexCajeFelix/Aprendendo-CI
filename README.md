# üöÄ Projeto PRP Live - Sistema CI/CD Reutiliz√°vel

[![CI/CD Pipeline](https://img.shields.io/badge/CI%2FCD-GitHub%20Actions-2088FF?logo=github-actions&logoColor=white)](https://github.com/features/actions)
[![Java](https://img.shields.io/badge/Java-17%2B-007396?logo=openjdk&logoColor=white)](https://openjdk.org/)
[![Maven](https://img.shields.io/badge/Maven-3.9%2B-C71A36?logo=apache-maven&logoColor=white)](https://maven.apache.org/)
[![Docker](https://img.shields.io/badge/Docker-Multi--Stage-2496ED?logo=docker&logoColor=white)](https://www.docker.com/)
[![SonarCloud](https://img.shields.io/badge/SonarCloud-Quality-orange?logo=sonarcloud&logoColor=white)](https://sonarcloud.io/)

## üìã Sobre o Projeto

Sistema de **CI/CD reutiliz√°vel e pronto para produ√ß√£o** para projetos Java/Spring Boot, desenvolvido usando a metodologia **BMAD (Brief, Milestones, Architecture, Development)**.

### üéØ Objetivos

- ‚úÖ **Reduzir tempo de setup** de 4 horas para < 10 minutos
- ‚úÖ **Padronizar pipelines** em todos os projetos
- ‚úÖ **Automatizar qualidade** com gates de qualidade
- ‚úÖ **Acelerar deploys** com build otimizado
- ‚úÖ **Garantir seguran√ßa** com vulnerability scanning

### üèÜ Features

| Feature | Status | Descri√ß√£o |
|---------|--------|-----------|
| üèóÔ∏è **Build & Test** | ‚úÖ | Workflow reutiliz√°vel para Java/Maven |
| üìä **SonarCloud** | ‚úÖ | An√°lise de qualidade e coverage |
| üîí **Security Scan** | ‚úÖ | Trivy vulnerability scanner |
| üê≥ **Docker Build** | ‚úÖ | Multi-stage otimizado (< 200MB) |
| üöÄ **Auto Deploy** | ‚úÖ | Push autom√°tico para DockerHub |
| üìö **Documenta√ß√£o** | ‚úÖ | Guia completo de configura√ß√£o |

---

## üöÄ Quick Start

### Para usar este CI/CD em seu projeto

```bash
# 1. Clone este reposit√≥rio
git clone https://github.com/SEU_USER/Projeto-prp-live.git
cd Projeto-prp-live

# 2. Copie os workflows para seu projeto
cp -r .github/workflows/* /path/to/seu-projeto/.github/workflows/
cp Dockerfile.template /path/to/seu-projeto/Dockerfile
cp sonar-project.properties.template /path/to/seu-projeto/sonar-project.properties

# 3. Configure secrets no GitHub (veja se√ß√£o abaixo)

# 4. Customize sonar-project.properties
# Edite e substitua {{PLACEHOLDERS}}

# 5. Commit e push
cd /path/to/seu-projeto
git add .github/ Dockerfile sonar-project.properties
git commit -m "ci: add CI/CD workflows"
git push origin main
```

### Configurar Secrets

No seu reposit√≥rio GitHub: **Settings ‚Üí Secrets and variables ‚Üí Actions**

| Secret | Valor | Como obter |
|--------|-------|------------|
| `SONAR_TOKEN` | Token SonarCloud | [sonarcloud.io](https://sonarcloud.io) ‚Üí My Account ‚Üí Security ‚Üí Generate Token |
| `DOCKERHUB_USERNAME` | Username DockerHub | Seu username |
| `DOCKERHUB_TOKEN` | Access token DockerHub | [hub.docker.com](https://hub.docker.com) ‚Üí Settings ‚Üí Security ‚Üí New Access Token |

---

## üìÇ Estrutura do Projeto

```
Projeto-prp-live/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ java-reusable.yml        # ‚≠ê Workflow reutiliz√°vel Java
‚îÇ       ‚îî‚îÄ‚îÄ main.yml                 # ‚≠ê Pipeline completo
‚îÇ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ agents.json                  # Configura√ß√£o BMAD Agents
‚îÇ   ‚îú‚îÄ‚îÄ mcp-config.json              # MCP configuration
‚îÇ   ‚îî‚îÄ‚îÄ templates.json               # Templates BMAD
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ ci-cd-configuration.md       # üìñ Guia completo de setup
‚îÇ   ‚îú‚îÄ‚îÄ workflows-README.md          # üìñ Guia r√°pido workflows
‚îÇ   ‚îú‚îÄ‚îÄ bmad-auto-system.md          # BMAD Auto System
‚îÇ   ‚îú‚îÄ‚îÄ bmad-collaborative-mode.md   # BMAD Colaborativo
‚îÇ   ‚îú‚îÄ‚îÄ best-practices.md            # Best practices
‚îÇ   ‚îî‚îÄ‚îÄ setup.md                     # Setup inicial
‚îÇ
‚îú‚îÄ‚îÄ PRPs/
‚îÇ   ‚îú‚îÄ‚îÄ bmad-output/                 # üì¶ Outputs BMAD
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ briefs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prds/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stories/
‚îÇ   ‚îú‚îÄ‚îÄ scripts/                     # ü§ñ Scripts BMAD
‚îÇ   ‚îú‚îÄ‚îÄ templates/                   # üìÑ Templates
‚îÇ   ‚îî‚îÄ‚îÄ examples/                    # Exemplos
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile.template              # ‚≠ê Dockerfile multi-stage
‚îú‚îÄ‚îÄ sonar-project.properties.template # ‚≠ê Config SonarCloud
‚îú‚îÄ‚îÄ .gitignore                       # Git ignore (Java + Node)
‚îî‚îÄ‚îÄ README.md                        # Este arquivo
```

---

## üîß Workflows Dispon√≠veis

### 1. java-reusable.yml

**Workflow reutiliz√°vel** para build e teste de projetos Java/Maven.

**Uso**:
```yaml
jobs:
  build:
    uses: ./.github/workflows/java-reusable.yml
    with:
      java-version: '17'
      maven-args: 'clean install'
      skip-tests: false
```

**Features**:
- ‚úÖ Setup Java (11, 17, 21)
- ‚úÖ Cache de depend√™ncias Maven
- ‚úÖ Build otimizado
- ‚úÖ Testes com JUnit
- ‚úÖ Coverage com Jacoco
- ‚úÖ Upload de artifacts

### 2. main.yml

**Pipeline completo** com 6 stages:

```
Push/PR ‚Üí Build & Test ‚Üí SonarCloud ‚Üí Security ‚Üí Docker Build ‚Üí Docker Push
```

**Stages**:
1. üèóÔ∏è **Build & Test** - Compila, testa, gera artifacts
2. üìä **SonarCloud** - An√°lise de qualidade e coverage
3. üîí **Security Scan** - Trivy vulnerability scan
4. üê≥ **Docker Build** - Cria imagem otimizada
5. üöÄ **Docker Push** - Deploy para DockerHub (s√≥ em main)
6. üìã **Summary** - Relat√≥rio completo

**Triggers**:
- Push em `main`/`master`
- Pull Requests
- Manual (workflow_dispatch)

---

## üìä Integra√ß√£o SonarCloud

### Setup

1. Crie projeto em [sonarcloud.io](https://sonarcloud.io)
2. Escolha "With GitHub Actions"
3. Gere token em: My Account ‚Üí Security
4. Configure secret `SONAR_TOKEN`

### Quality Gates

O pipeline **bloqueia merge** se:
- ‚ùå Quality Gate = FAILED
- ‚ùå Vulnerabilidades HIGH/CRITICAL
- ‚ùå Bugs cr√≠ticos

O pipeline **avisa** mas n√£o bloqueia se:
- ‚ö†Ô∏è Coverage < 80%
- ‚ö†Ô∏è Code smells acima do threshold

### Badges

Adicione ao README do seu projeto:

```markdown
[![Quality Gate](https://sonarcloud.io/api/project_badges/measure?project=ORG_REPO&metric=alert_status)](https://sonarcloud.io/dashboard?id=ORG_REPO)
[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=ORG_REPO&metric=coverage)](https://sonarcloud.io/dashboard?id=ORG_REPO)
```

---

## üê≥ Docker

### Dockerfile Multi-Stage

Otimizado para produ√ß√£o:

- **Stage 1 (Builder)**: Maven 3.9 + JDK 17 (~700MB)
- **Stage 2 (Runtime)**: JRE 17 Alpine (~150MB) ‚úÖ

**Benef√≠cios**:
- ‚úÖ Imagem final 60% menor
- ‚úÖ Menos superf√≠cie de ataque
- ‚úÖ Melhor cache de layers
- ‚úÖ Health check integrado

### Build Local

```bash
# Build
docker build -t my-app:test .

# Run
docker run -p 8080:8080 my-app:test

# Verificar tamanho
docker images my-app:test
```

### Tags no DockerHub

Automaticamente criadas:
- `latest` - √öltima vers√£o em main
- `v1.0.0` - Vers√£o do pom.xml
- `main-abc123` - Commit SHA

---

## üìö Documenta√ß√£o

| Documento | Descri√ß√£o |
|-----------|-----------|
| [ci-cd-configuration.md](docs/ci-cd-configuration.md) | üìñ Guia completo de configura√ß√£o (40+ p√°ginas) |
| [workflows-README.md](docs/workflows-README.md) | üìñ Guia r√°pido de workflows |
| [bmad-auto-system.md](docs/bmad-auto-system.md) | ü§ñ Sistema BMAD Autom√°tico |
| [bmad-collaborative-mode.md](docs/bmad-collaborative-mode.md) | ü§ù Modo Colaborativo BMAD |

---

## ü§ñ Sistema BMAD

Este projeto foi desenvolvido usando **BMAD** (Brief, Milestones, Architecture, Development):

### Metodologia

1. **üìã Brief** - An√°lise de requisitos completa
2. **üìä PRD** - Product Requirements Document
3. **üèóÔ∏è Architecture** - Decis√µes arquiteturais (ADRs)
4. **üìù Stories** - User stories com crit√©rios de aceita√ß√£o
5. **üíª Development** - Implementa√ß√£o com c√≥digo real
6. **üß™ QA** - Valida√ß√£o e testes

### Documentos BMAD Gerados

- [Brief](PRPs/bmad-output/briefs/ci-cd-system-brief.md)
- [PRD](PRPs/bmad-output/prds/ci-cd-system-prd.md)
- [Arquitetura](PRPs/bmad-output/architecture/ci-cd-system-architecture.md)
- [Stories](PRPs/bmad-output/stories/ci-cd-system/index.md)

---

## üõ†Ô∏è Troubleshooting

### Pipeline falhou?

1. **Build failed**: 
   ```bash
   mvn clean install
   ```

2. **SonarCloud failed**: 
   - Verificar `SONAR_TOKEN` configurado
   - Ver logs em Actions ‚Üí Run ‚Üí sonar-analysis

3. **Docker push failed**: 
   - Verificar `DOCKERHUB_USERNAME` e `DOCKERHUB_TOKEN`
   - Confirmar reposit√≥rio existe no DockerHub

### Testar localmente

```bash
# Instalar act (GitHub Actions local)
brew install act  # macOS
# ou
curl https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash

# Rodar workflow
act -j build-and-test

# Com secrets
echo "SONAR_TOKEN=xxx" > .secrets
act -j sonar-analysis --secret-file .secrets
```

### Validar YAML

```bash
# Instalar actionlint
brew install actionlint

# Validar workflows
actionlint .github/workflows/*.yml
```

---

## üìà Performance

### Benchmarks

| M√©trica | Sem Cache | Com Cache |
|---------|-----------|-----------|
| Build & Test | 4-5 min | 1-2 min ‚ö° |
| SonarCloud | 1-2 min | 1-2 min |
| Security Scan | 1 min | 1 min |
| Docker Build | 3-4 min | 1-2 min ‚ö° |
| **Total** | **9-12 min** | **4-7 min** ‚ö° |

### Otimiza√ß√µes Aplicadas

- ‚úÖ Maven dependency cache
- ‚úÖ Docker layer caching (GitHub Cache)
- ‚úÖ Parallel jobs quando poss√≠vel
- ‚úÖ Conditional steps (skip quando n√£o necess√°rio)

---

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas!

1. Fork o projeto
2. Crie uma branch: `git checkout -b feature/minha-feature`
3. Commit: `git commit -m 'feat: adiciona minha feature'`
4. Push: `git push origin feature/minha-feature`
5. Abra um Pull Request

### Padr√£o de Commits

Seguimos [Conventional Commits](https://www.conventionalcommits.org/):

```
feat: nova feature
fix: corre√ß√£o de bug
docs: atualiza√ß√£o de documenta√ß√£o
ci: mudan√ßas em CI/CD
refactor: refatora√ß√£o de c√≥digo
test: adi√ß√£o de testes
```

---

## üìû Suporte

- üìñ **Documenta√ß√£o**: [docs/](docs/)
- üêõ **Issues**: [GitHub Issues](../../issues)
- üí¨ **Discuss√µes**: [GitHub Discussions](../../discussions)
- üìß **Email**: devops@exemplo.com

---

## üìä Status do Projeto

| Fase | Status | Conclus√£o |
|------|--------|-----------|
| üìã Brief | ‚úÖ Completo | 100% |
| üìä PRD | ‚úÖ Completo | 100% |
| üèóÔ∏è Arquitetura | ‚úÖ Completo | 100% |
| üìù Stories | ‚úÖ Completo | 100% |
| üíª Implementa√ß√£o | ‚úÖ Completo | 100% |
| üìö Documenta√ß√£o | ‚úÖ Completo | 100% |
| üß™ Testes | ‚è≥ Em andamento | 80% |

---

## üìú Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja [LICENSE](LICENSE) para mais detalhes.

---

## üéØ Roadmap

### ‚úÖ Fase 1: MVP (Completo)
- Workflow Java reutiliz√°vel
- Pipeline completo
- SonarCloud integration
- DockerHub integration
- Documenta√ß√£o completa

### üîÑ Fase 2: Melhorias (Em planejamento)
- [ ] Suporte a Gradle
- [ ] Matrix builds (m√∫ltiplas vers√µes Java)
- [ ] Notifica√ß√µes Slack/Discord
- [ ] Caching remoto avan√ßado

### üîÆ Fase 3: Enterprise (Futuro)
- [ ] Deploy para Kubernetes
- [ ] Multi-cloud support
- [ ] Advanced security scanning
- [ ] Performance monitoring

---

## üèÜ Agradecimentos

Desenvolvido com a metodologia **BMAD** usando:
- ‚úÖ GitHub Actions
- ‚úÖ SonarCloud
- ‚úÖ DockerHub
- ‚úÖ Trivy Security Scanner
- ‚úÖ Maven
- ‚úÖ Spring Boot (exemplos)

---

## üìå Links √öteis

- üìñ [GitHub Actions Docs](https://docs.github.com/en/actions)
- üìä [SonarCloud Docs](https://docs.sonarcloud.io/)
- üê≥ [Docker Best Practices](https://docs.docker.com/develop/dev-best-practices/)
- ‚òï [Maven Docs](https://maven.apache.org/guides/)
- üîí [Trivy Security Scanner](https://aquasecurity.github.io/trivy/)

---

<div align="center">

**‚≠ê Se este projeto foi √∫til, considere dar uma estrela! ‚≠ê**

**Feito com ‚ù§Ô∏è usando metodologia BMAD**

**Vers√£o**: 1.0.0 | **√öltima atualiza√ß√£o**: 24/10/2025

</div>

